<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä»·æ ¼è®¡ç®—å™¨</title>
    <style>
        /* å°† sidebar.css ä¸­çš„æ‰€æœ‰å†…å®¹å¤åˆ¶ç²˜è´´åˆ°è¿™é‡Œ */
        :root {
            --primary-color: #4361ee;
            --secondary-color: #3a0ca3;
            --success-color: #4cc9f0;
            --danger-color: #f94144;
            --border-radius: 8px;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        /* è°ƒæ•´ body/container æ ·å¼ä»¥é€‚åº”æ‰‹æœºå…¨å±æ˜¾ç¤º */
        body {
            width: 100%;
            /* æ‰‹æœºç«¯å¯èƒ½ä¸éœ€è¦ 100vhï¼Œè®©å†…å®¹è‡ªç„¶å»¶ä¼¸ */
            min-height: 100vh; 
            background: #f8f9fa;
        }

        /* ç§»é™¤ body çš„ overflow: hidden å’Œ height: 100vh; */
        /* å…³é”®ï¼šè®©è®¡ç®—å™¨å æ®å±å¹•å¯è§åŒºåŸŸï¼Œæˆ–åªä¿ç•™å¸ƒå±€æ ·å¼ */
        .calculator-sidebar {
            height: auto; /* é€‚åº”å†…å®¹ */
            min-height: 100vh; /* ç¡®ä¿åœ¨å†…å®¹å°‘æ—¶ä¹Ÿèƒ½å æ®å…¨å± */
            width: 100%; /* å…¨å±å®½åº¦ */
            display: flex;
            flex-direction: column;
            box-shadow: none; /* ç§»é™¤ä¾§è¾¹æ é˜´å½± */
        }
        
        /* å…¶ä»– CSS ä¿æŒä¸å˜... (ä» sidebar.css å¤åˆ¶å‰©ä½™éƒ¨åˆ†) */
        
        .sidebar-header {
            padding: 15px 20px;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #e0e0e0;
        }
        
        .sidebar-header h2 {
            font-size: 1.2rem;
            font-weight: 600;
        }
        
        /* ç½‘é¡µç‰ˆä¸­ç§»é™¤å…³é—­æŒ‰é’®æˆ–æ”¹å˜å…¶åŠŸèƒ½ */
        #close-sidebar {
            /* åœ¨ç‹¬ç«‹ç½‘é¡µä¸­ï¼Œè¿™ä¸ªæŒ‰é’®é€šå¸¸ç”¨äºè¿”å›æˆ–éšè—ï¼Œ
               ä½†è¿™é‡Œæˆ‘ä»¬æš‚æ—¶è®©å®ƒä¿æŒåŸæ ·æˆ–éšè— */
            display: none; /* ç½‘é¡µç‰ˆé€šå¸¸ä¸éœ€è¦å…³é—­è®¡ç®—å™¨æœ¬èº« */
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            font-size: 1.5rem;
            line-height: 1;
            cursor: pointer;
            transition: background 0.2s ease;
        }
        
        #close-sidebar:hover {
            background: rgba(255, 255, 255, 0.4);
        }
        
        .sidebar-content {
            flex-grow: 1;
            padding: 20px;
            /* ç§»é™¤ overflow-y: auto; ä¾èµ– body çš„æ»šåŠ¨ */
        }
        
        .recommended-price {
            text-align: center;
            margin-bottom: 25px;
            padding: 15px;
            background: #e6f0ff;
            border-radius: var(--border-radius);
            border: 1px solid #cce0ff;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        
        .recommended-price h3 {
            font-size: 1rem;
            color: var(--primary-color);
            margin-bottom: 5px;
        }
        
        .price-amount {
            font-size: 2rem;
            font-weight: 700;
            color: var(--secondary-color);
            letter-spacing: 1px;
        }
        
        .input-group {
            margin-bottom: 15px;
        }
        
        .input-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            color: #495057;
            font-size: 0.9rem;
        }
        
        .input-group input {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid #ced4da;
            border-radius: var(--border-radius);
            font-size: 1rem;
            transition: border-color 0.2s ease;
        }
        
        .input-group input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 2px rgba(67, 97, 238, 0.2);
        }
        
        .calculate-btn {
            width: 100%;
            padding: 12px;
            background: var(--primary-color);
            color: white;
            border: none;
            border-radius: var(--border-radius);
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.3s ease, transform 0.1s ease;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .calculate-btn:hover {
            background: var(--secondary-color);
        }
        
        .calculate-btn:active {
            transform: translateY(1px);
        }
        
        .calculate-btn .icon {
            margin-right: 8px;
        }
        
        .results-container {
            background: #f8f9fa;
            border-radius: var(--border-radius);
            padding: 15px;
            margin-top: 20px;
            border: 1px solid #e9ecef;
        }
        
        .result-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 1px solid #e9ecef;
        }
        
        .result-item:last-child {
            margin-bottom: 0;
            padding-bottom: 0;
            border-bottom: none;
        }
        
        .result-label {
            font-size: 0.9rem;
            color: #6c757d;
        }
        
        .result-value {
            font-size: 1rem;
            font-weight: 600;
            color: #212529;
        }
        
        .profit-positive {
            color: #28a745;
        }
        
        .profit-negative {
            color: #dc3545;
        }
    </style>
</head>
<body>
    <div class="calculator-sidebar">
        <div class="sidebar-header">
            <h2>â‚© éŸ©å¸ä»·æ ¼è®¡ç®—å™¨</h2>
            <button id="close-sidebar" style="display: none;">Ã—</button> 
        </div>
        
        <div class="sidebar-content">
            <div class="recommended-price">
                <h3>æ¨èå®šä»· (éŸ©å¸)</h3>
                <div class="price-amount" id="recommended-price-krw">â‚© 0</div>
            </div>
            
            <div class="input-group">
                <label for="cost">å•å“æˆæœ¬ (å…ƒ)</label>
                <input type="number" id="cost" value="10" step="0.1">
            </div>
            
            <div class="input-group">
                <label for="weight">å•ä¸ªé‡é‡ (å…‹)</label>
                <input type="number" id="weight" value="200">
            </div>
            
            <div class="input-group">
                <label for="quantity">äº§å“ä¸ªæ•°</label>
                <input type="number" id="quantity" value="10">
            </div>
            
            <div class="input-group">
                <label for="domestic-shipping">å›½å†…è¿è´¹ (å…ƒ)</label>
                <input type="number" id="domestic-shipping" value="10">
            </div>
            
            <div class="input-group">
                <label for="simple-fee">ç®€æ˜“è´¹ (å…ƒ)</label>
                <input type="number" id="simple-fee" value="15">
            </div>
            
            <div class="input-group">
                <label for="package-quantity">åŒ…è£¹æ•°é‡ (ä¸ª)</label>
                <input type="number" id="package-quantity" value="1">
            </div>
            
            <div class="input-group">
                <label for="actual-price-krw">å®é™…å®šä»· (éŸ©å…ƒ)</label>
                <input type="number" id="actual-price-krw" value="0" step="100">
            </div>
            
            <button class="calculate-btn" id="calculate-btn">
                <span class="icon">ğŸ“Š</span> è®¡ç®—ä»·æ ¼ä¸åˆ©æ¶¦
            </button>
            
            <div class="results-container">
                <div class="result-item">
                    <span class="result-label">å›½é™…è¿è´¹ (å…ƒ):</span>
                    <span class="result-value" id="international-shipping">0.00</span>
                </div>
                
                <div class="result-item">
                    <span class="result-label">åˆ†å•è¿è´¹ (å…ƒ):</span>
                    <span class="result-value" id="split-shipping">0.00</span>
                </div>
                
                <div class="result-item">
                    <span class="result-label">ç†æƒ³åˆ©æ¶¦ (å…ƒ):</span>
                    <span class="result-value" id="ideal-profit">0.00</span>
                </div>
                
                <div class="result-item">
                    <span class="result-label">å®é™…åˆ©æ¶¦ (å…ƒ):</span>
                    <span class="result-value" id="actual-profit">0.00</span>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // å°† sidebar.js çš„å†…å®¹å¤åˆ¶ç²˜è´´åˆ°è¿™é‡Œï¼Œå¹¶è¿›è¡Œä¿®æ”¹
        
        // æ±‡ç‡å¸¸é‡
        const EXCHANGE_RATE = 190;

        // DOMåŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            initializeCalculator();
            setupEventListeners();
        });

        function initializeCalculator() {
            // **ã€åˆ é™¤æˆ–ä¿®æ”¹ã€‘** ä¾§è¾¹æ å…³é—­é€»è¾‘
            // ç½‘é¡µç‰ˆä¸å†éœ€è¦é€šè¿‡ postMessage é€šçŸ¥çˆ¶çº§å…³é—­ï¼Œ
            // å› æ­¤å¯ä»¥åˆ é™¤ document.getElementById('close-sidebar')... çš„ä»£ç ã€‚
            
            // åˆå§‹è®¡ç®—
            calculatePrice();
        }

        function setupEventListeners() {
            // ä¸ºæ‰€æœ‰è¾“å…¥å­—æ®µæ·»åŠ å®æ—¶è®¡ç®—
            const inputs = document.querySelectorAll('input');
            inputs.forEach(input => {
                input.addEventListener('input', calculatePrice);
            });
            
            // è®¡ç®—æŒ‰é’®
            document.getElementById('calculate-btn').addEventListener('click', calculatePrice);
        }

        // calculatePrice å‡½æ•°ä¿æŒä¸å˜
        function calculatePrice() {
            // è·å–è¾“å…¥å€¼
            const cost = parseFloat(document.getElementById('cost').value) || 0;
            const weight = parseFloat(document.getElementById('weight').value) || 0;
            const quantity = parseFloat(document.getElementById('quantity').value) || 0;
            const domesticShipping = parseFloat(document.getElementById('domestic-shipping').value) || 0;
            const simpleFee = parseFloat(document.getElementById('simple-fee').value) || 0;
            const packageQuantity = parseFloat(document.getElementById('package-quantity').value) || 0;
            const actualPriceKrw = parseFloat(document.getElementById('actual-price-krw').value) || 0;
            
            // è®¡ç®—å›½é™…è¿è´¹
            const internationalShipping = 30 + (weight * quantity / 1000) * 5 + simpleFee;
            
            // è®¡ç®—åˆ†å•è¿è´¹
            const splitShipping = packageQuantity > 1 ? (packageQuantity - 1) * 30 : 0;
            
            // è®¡ç®—ç†æƒ³åˆ©æ¶¦
            const idealProfit = (cost * quantity + domesticShipping) * 0.7;
            
            // è®¡ç®—æ¨èå®šä»·ï¼ˆäººæ°‘å¸ï¼‰
            const recommendedPriceCny = (idealProfit + cost * quantity + domesticShipping + internationalShipping + splitShipping) * 1.08 / quantity;
            
            // è®¡ç®—æ¨èå®šä»·ï¼ˆéŸ©å¸ï¼‰
            const recommendedPriceKrw = recommendedPriceCny * EXCHANGE_RATE;
            
            // è®¡ç®—å®é™…åˆ©æ¶¦
            const actualProfit = actualPriceKrw * quantity * 0.92 / EXCHANGE_RATE - cost * quantity - domesticShipping - internationalShipping - splitShipping;
            
            // æ›´æ–°UI
            updateUI(internationalShipping, splitShipping, idealProfit, recommendedPriceKrw, actualProfit);
        }

        // updateUI å‡½æ•°ä¿æŒä¸å˜
        function updateUI(internationalShipping, splitShipping, idealProfit, recommendedPriceKrw, actualProfit) {
            document.getElementById('international-shipping').textContent = internationalShipping.toFixed(2);
            document.getElementById('split-shipping').textContent = splitShipping.toFixed(2);
            document.getElementById('ideal-profit').textContent = idealProfit.toFixed(2);
            document.getElementById('recommended-price-krw').textContent = 'â‚© ' + Math.round(recommendedPriceKrw).toLocaleString();
            
            const actualProfitElement = document.getElementById('actual-profit');
            actualProfitElement.textContent = actualProfit.toFixed(2);
            
            // æ ¹æ®åˆ©æ¶¦æ­£è´Ÿè®¾ç½®é¢œè‰²
            if (actualProfit >= 0) {
                actualProfitElement.className = 'result-value profit-positive';
            } else {
                actualProfitElement.className = 'result-value profit-negative';
            }
        }
    </script>
</body>
</html>